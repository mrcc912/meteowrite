var AlchemyAPI = require('alchemy-api');
var alchemy = new AlchemyAPI(apiKey);
var request = require('request');

var apiKey = "3e8f9346f19fae52967b9586d4fd3808bc6d8b4e";

var keywordHost = "www.access.alchemyapi.com";
var keywordPath = "/calls/text/TextGetRankedKeywords";

var conceptHost = "www.access.alchemyapi.com";
var conceptPath = "/calls/text/TextGetRankedConcepts";

var entityHost = "www.access.alchemyapi.com";
var entityPath = "/calls/text/TextGetRankedNamedEntities";


/*
var nameParams = new Object();
keywordParams["apikey"] = apiKey;
keywordParams["text"] = "";
keywordParams["outputmode"] = "json";
//nameParams["url"]
//nameParams["jsonp"] 

var concParams = new Object();
concParams["apikey"] = apiKey;
concParams["text"] = "";
concParams["outputmode"] = "json";
//concParams["url"]
//concParams["jsonp"] 

var entityParams = new Object();
entityParams["apikey"] = apiKey;
entityParams["text"] = "";
entityParams["outputmode"] = "json";
//concParams["url"]
//concParams["jsonp"] 


*/
exports.getKeywords = function(id, text, func) {
  /*
    keywordParams["text"] = encodeURIComponent(text);
  concParams["text"] = encodeURIComponent(text);
  entityParams["text"] = encodeURIComponent(text);  
 
  var keywordPathString = keywordPath + "?";
 
  for (var key in keywordParams) {
    var value = keywordParams[key];
    keywordPathString = keywordPathString + key + "='" + value + "'&"; 
  } 

  var options = {
    hostname:  keywordHost, 
    path: keywordPathString
  }
*/
    request({
	method: 'POST',
	uri: 'http://access.alchemyapi.com/calls/text/TextGetRankedKeywords',
	body: 'apikey=' + apiKey +
            '&text='+ text +
            '&outputMode=json',
    }, function(err, res, body){
	result = JSON.parse(body);
	console.log('Category: ', result.language);
	console.log('Category: ', result.category);
	console.log(result.keywords[0]);
	func(id, result);
    });


 /* 
  alchemy.relations('TEXT', {'outputmode':'json'}, function(err,response) {
    if (err) throw err;
    var relations = response.relations;
    console.log(relations);
  });
  

    alchemy.keywords('TEXT', {'outputmode':'json'}, function(err,response) {
	if (err) throw err;
	var relations = response.keywords;
	console.log(relations);
    });

   
  alchemy.concepts('TEXT', {'outputmode':'json'}, function(err,response) {
    if (err) throw err;
    var relations = response.concepts;
    console.log(relations);
  });
 */
}
